<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
	PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="org.shopmoon.mapper.ContactMapper">
	
	<!--  문의 글 등록 -->
	<insert id="contactWrite">
		insert into contact values(
			SEQ_CONTACT.NEXTVAL
			, #{memberId}
			, #{contactCategory}
			, #{contactTitle}
			, #{contactContents}
			, 'N'
			, 'N'
			, sysdate
		)
	</insert>
	
	<!-- 모든 문의 글 조회 -->
	<select id="contactGetList" resultType="org.shopmoon.domain.ContactVO">
		<![CDATA[
			select *
			 from ( select /*+ INDEX_DESC(c SYS_C0011272) */ 
					rownum as rn
					, CON_NO as contactNo
					, M_ID as memberId
					, CON_CATEGORY as contactCategory
					, CON_TITLE as contactTitle
					, CON_CONTENTS as contactContents
					, CON_Reply as contactReply
					, CON_ANSWER as contactAnswer
					, CON_REG_DATE as contactDate
			 from contact c
			where 
	    ]]>
	    
		    <if test="keyword != null">
				M_ID like '%' || #{keyword} || '%' and
		    </if>
		   
	   <![CDATA[
	   		rownum <= #{pageNum} * #{amount}
	   		)
        where rn > (#{pageNum} - 1) * #{amount}
	   
	   ]]>
	</select>
	
	  <!-- 믄의 글 총 수 -->
      <select id="contactGetTotal" resultType="int">
      
          select count(*) from contact
          
          <if test="keyword != null">
             where M_ID like '%' || #{keyword} || '%'
          </if>
      </select> 
      
      
</mapper>
